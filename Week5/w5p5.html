<!DOCTYPE html>
<html>
<head>
  <form action="/~s184984/Worksheet5.html">
    <button class="btn btn-primary btn-lg">Go back</button>
  </form>
  <br>
  <h1>Worksheet 5 - Part 3</h1>
  <title>W05P3</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script id="vertex-shader" type="x-shader/x-vertex">
  precision mediump float;  
    
  attribute vec3 vPosition;
  attribute vec4 color;
  attribute vec3 vNormals;
  varying vec4 fColor;

  varying vec3 L_rd;
  varying vec3 L_rs;
  varying vec3 L_ra;
  varying vec3 L_o;

  uniform mat4 viewMatrix;
  uniform mat4 projectionMatrix;
  uniform mat4 modelMatrix;

  uniform vec4 lightPos;
  uniform vec3 L_i;
  uniform vec3 eye;
  uniform float k_a;
  uniform float k_d;
  uniform float k_s;
  uniform float s;

    void main() {
      vec4 pos = modelMatrix * viewMatrix * vec4(vPosition, 1.0); 
      vec4 normals = modelMatrix * viewMatrix * vec4(vNormals, 1.0);

      vec3 light = (viewMatrix * lightPos).xyz;
      vec3 w_i = lightPos.w == 0.0 ? normalize(light) : normalize(light - pos.xyz);

      vec3 w_r = 2.0 * dot(w_i, normalize(normals.xyz)) * normalize(normals.xyz) - w_i;

      vec3 w_o = -normalize((viewMatrix * pos).xyz); 

      L_rd = k_d * L_i * max(dot(normals.xyz, w_i), 0.0) * color.xyz; 
      L_rs = k_s * L_i * pow(max(dot(w_r, w_o), 0.0), s);
      L_ra = k_a * L_i; 
      
      L_o = L_rd + L_rs + L_ra;
      fColor = vec4(L_o, 1.0);
      
      gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(vPosition, 1.0); // projectionMatrix * viewMatrix not working
      gl_PointSize = 20.0;
    }
    
</script>

<!--
  medium precision, 
  its the amount of precision used when calculating floats
-->

<script id="fragment-shader" type="x-shader/x-fragment">

  precision mediump float;
  varying vec4 fColor;

    void main() {
      gl_FragColor = fColor;
    }
</script>

<script type="text/javascript" src="../common/webgl-utils.js"></script>
<script type="text/javascript" src="../common/initShaders.js"></script>
<script type="text/javascript" src="../common/MV.js"></script>
<script type="text/javascript" src="../common/OBJParser.js"></script>
<script type="text/javascript" src="w5p5.js"></script>
</head>

<body>
  <canvas id="c" width="512" height="512">
  </canvas>
</body><br>

<label> Emitted radiance (L_e): &emsp;&emsp;&emsp;&emsp;&nbsp;&emsp;&emsp;&emsp;&emsp; 0.0 <input id="L_e" type="range" min="0" max="2" step="0.1" value="1" />
  2.0 </label> <br>
  
  <label> Ambient coefficient (K_a): &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; 0.0 <input id="K_a" type="range" min="0" max="1" step="0.05" value="0.1" />
    1.0 </label><br>
  
  <label> Diffuse coefficient (K_d): &emsp;&emsp;&emsp;&ensp;&emsp;&emsp;&emsp;&emsp; 0.0 <input id="K_d" type="range" min="0" max="1" step="0.05" value="0.9" />
  1.0 </label><br>
  
  <label> Specular coefficient (K_s): &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; 0.0 <input id="K_s" type="range" min="0" max="1" step="0.05" value="0.5" />
    1.0 </label><br>
      
  <label> Shininess (s):&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&ensp;&emsp;&emsp;&emsp;&emsp; 1.0 <input id="s" type="range" min="1" max="1000" step="5" value="50" />
    1000 </label><br>
  </div>

<!--this is a comment-->
</html>

